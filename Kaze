-- Kaze UI Library (fixed, centered Section paragraphs)
-- Notes:
--  - Full, ready-to-drop KazeUI.lua
--  - Paragraphs can be added to a Section using Section:AddParagraph(title, body)
--    which will center the paragraph inside the section and match the section width.
--  - Backwards-compatible: Tab:Paragraph(title, body) still works (it will be added
--    to the pageContent and not the section).
--  - Fixed nil Color errors and reduced glow opacity so there's no dark "blob".
--  - Paragraph text is white for readability.

local KazeUI = {}
KazeUI.__index = KazeUI

-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")
local TextService = game:GetService("TextService")
local LP = Players.LocalPlayer

-- ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "KazeUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = LP:WaitForChild("PlayerGui")

-- UIScale
local UIScale = Instance.new("UIScale")
UIScale.Parent = ScreenGui
local function UpdateScale()
	local size = workspace.CurrentCamera.ViewportSize
	if size.X < 600 then
		UIScale.Scale = math.clamp(size.X / 800, 0.5, 1)
	else
		UIScale.Scale = math.clamp(size.X / 1920, 0.6, 1)
	end
end
UpdateScale()
workspace.CurrentCamera:GetPropertyChangedSignal("ViewportSize"):Connect(UpdateScale)

-- Helpers
local function FormatImage(id)
	if not id then return "" end
	id = tostring(id)
	local clean = string.gsub(id, "%D", "")
	if clean == "" then return "" end
	return "rbxassetid://" .. clean
end

local function MakeDraggable(dragPart, targetPart)
	local dragging = false
	local dragInput, dragStart, startPos
	local function update(input)
		if not dragStart or not startPos then return end
		local delta = input.Position - dragStart
		targetPart.Position = UDim2.new(
			startPos.X.Scale, startPos.X.Offset + delta.X,
			startPos.Y.Scale, startPos.Y.Offset + delta.Y
		)
	end
	dragPart.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = targetPart.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
					dragInput = nil
				end
			end)
		end
	end)
	dragPart.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			dragInput = input
		end
	end)
	UIS.InputChanged:Connect(function(input)
		if input == dragInput and dragging then
			update(input)
		end
	end)
end

-- Neon loop (safe)
local function StartNeonLoop(target)
	if not target then return end
	spawn(function()
		while target and target.Parent do
			local propName
			if pcall(function() return target.Color end) then
				propName = "Color"
			elseif pcall(function() return target.BackgroundColor3 end) then
				propName = "BackgroundColor3"
			end
			if not propName then break end
			local tweenInfo = TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true)
			local ok, tween = pcall(function()
				return TweenService:Create(target, tweenInfo, { [propName] = Color3.fromRGB(0,255,255) })
			end)
			if ok and tween then tween:Play() end
			break
		end
	end)
end

-- CreateWindow
function KazeUI:CreateWindow(config)
	config = config or {}
	local Title = config.Title or "Kaze UI"
	local Author = config.Author or "Unknown"
	local Version = config.Version or "1.0"
	local MainIcon = FormatImage(config.Icon or "6031763447")
	local OpenIcon = FormatImage((config.OpenButton and config.OpenButton.Icon) or config.Icon or "6031763447")
	local MiniButtonSize = UDim2.fromOffset(60, 60)
	local Callback = config.Callback

	-- Main window frame
	local Window = Instance.new("Frame")
	Window.Name = "MainWindow"
	Window.Size = UDim2.fromOffset(650, 420)
	Window.Position = UDim2.fromScale(0.5, 0.5)
	Window.AnchorPoint = Vector2.new(0.5, 0.5)
	Window.BackgroundColor3 = Color3.fromRGB(20,20,25)
	Window.BorderSizePixel = 0
	Window.Parent = ScreenGui
	Window.ClipsDescendants = true
	Instance.new("UICorner", Window).CornerRadius = UDim.new(0, 14)

	local WindowStroke = Instance.new("UIStroke")
	WindowStroke.Color = Color3.fromRGB(0,160,255)
	WindowStroke.Thickness = 2.5
	WindowStroke.Parent = Window
	StartNeonLoop(WindowStroke)

	-- TopBar
	local TopBar = Instance.new("Frame")
	TopBar.Name = "TopBar"
	TopBar.Size = UDim2.new(1,0,0,56)
	TopBar.BackgroundColor3 = Color3.fromRGB(15,15,20)
	TopBar.BorderSizePixel = 0
	TopBar.Parent = Window
	Instance.new("UICorner", TopBar).CornerRadius = UDim.new(0,14)
	MakeDraggable(TopBar, Window)

	-- Avatar + labels
	local Avatar = Instance.new("ImageLabel")
	Avatar.Name = "Avatar"
	Avatar.Size = UDim2.fromOffset(36,36)
	Avatar.Position = UDim2.fromOffset(12,10)
	Avatar.BackgroundColor3 = Color3.fromRGB(30,30,35)
	Avatar.Image = MainIcon
	Avatar.Parent = TopBar
	Instance.new("UICorner", Avatar).CornerRadius = UDim.new(1,0)
	local avatarStroke = Instance.new("UIStroke", Avatar)
	avatarStroke.Color = Color3.fromRGB(0,140,200)
	avatarStroke.Thickness = 1

	local TitleLabel = Instance.new("TextLabel")
	TitleLabel.Size = UDim2.new(1, -220, 0, 22)
	TitleLabel.Position = UDim2.fromOffset(56,8)
	TitleLabel.BackgroundTransparency = 1
	TitleLabel.Text = Title
	TitleLabel.TextColor3 = Color3.fromRGB(235,235,235)
	TitleLabel.Font = Enum.Font.GothamBold
	TitleLabel.TextSize = 16
	TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
	TitleLabel.Parent = TopBar

	local SubLabel = Instance.new("TextLabel")
	SubLabel.Size = UDim2.new(1, -220, 0, 18)
	SubLabel.Position = UDim2.fromOffset(56,30)
	SubLabel.BackgroundTransparency = 1
	SubLabel.Text = Author .. " | v" .. Version
	SubLabel.TextColor3 = Color3.fromRGB(160,160,160)
	SubLabel.Font = Enum.Font.Gotham
	SubLabel.TextSize = 13
	SubLabel.TextXAlignment = Enum.TextXAlignment.Left
	SubLabel.Parent = TopBar

	-- Top divider
	local TopDivider = Instance.new("Frame")
	TopDivider.Name = "TopDivider"
	TopDivider.Size = UDim2.new(1,0,0,2)
	TopDivider.Position = UDim2.new(0,0,1,-2)
	TopDivider.BackgroundColor3 = Color3.fromRGB(0,200,255)
	TopDivider.BorderSizePixel = 0
	TopDivider.ZIndex = 5
	TopDivider.Parent = TopBar
	Instance.new("UICorner", TopDivider).CornerRadius = UDim.new(0,6)
	local topDivStroke = Instance.new("UIStroke")
	topDivStroke.Parent = TopDivider
	topDivStroke.Color = WindowStroke.Color
	topDivStroke.Thickness = WindowStroke.Thickness
	topDivStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	StartNeonLoop(topDivStroke)

	-- Traffic light buttons
	local defaultWindowSize = UDim2.fromOffset(650,420)
	local lastNormalSize = defaultWindowSize
	local lastNormalPosition = UDim2.fromScale(0.5,0.5)
	local lastNormalAnchor = Vector2.new(0.5,0.5)
	local toggledMaximized = false
	local function createCircleButton(name, offsetX, color)
		local btn = Instance.new("TextButton")
		btn.Name = name
		btn.Size = UDim2.fromOffset(18,18)
		btn.Position = UDim2.new(1, offsetX, 0.5, -9)
		btn.BackgroundColor3 = color
		btn.BorderSizePixel = 0
		btn.Text = ""
		btn.Parent = TopBar
		Instance.new("UICorner", btn).CornerRadius = UDim.new(1,0)
		local stroke = Instance.new("UIStroke", btn)
		stroke.Color = Color3.fromRGB(0,0,0)
		stroke.Thickness = 1
		return btn
	end
	local BtnGreen = createCircleButton("BtnGreen", -120, Color3.fromRGB(117,204,50))
	local BtnYellow = createCircleButton("BtnYellow", -88, Color3.fromRGB(255,204,51))
	local BtnRed = createCircleButton("BtnRed", -56, Color3.fromRGB(235,80,80))

	-- MiniButton for minimize
	local MiniButton = Instance.new("ImageButton")
	MiniButton.Name = "MiniButton"
	MiniButton.Size = MiniButtonSize
	MiniButton.Position = UDim2.fromScale(0.1,0.1)
	MiniButton.BackgroundColor3 = Color3.fromRGB(20,20,25)
	MiniButton.BorderSizePixel = 0
	MiniButton.Visible = false
	MiniButton.Parent = ScreenGui
	MiniButton.ZIndex = 999
	MiniButton.ScaleType = Enum.ScaleType.Slice
	MiniButton.SliceCenter = Rect.new(4,4,60,60)
	Instance.new("UICorner", MiniButton).CornerRadius = UDim.new(0,12)
	local miniPadding = Instance.new("UIPadding", MiniButton)
	miniPadding.PaddingTop = UDim.new(0,4); miniPadding.PaddingBottom = UDim.new(0,4)
	miniPadding.PaddingLeft = UDim.new(0,4); miniPadding.PaddingRight = UDim.new(0,4)
	local MiniIcon = Instance.new("ImageLabel")
	MiniIcon.Size = UDim2.fromScale(1,1)
	MiniIcon.Position = UDim2.fromScale(0.5,0.5)
	MiniIcon.AnchorPoint = Vector2.new(0.5,0.5)
	MiniIcon.BackgroundTransparency = 1
	MiniIcon.Image = OpenIcon
	MiniIcon.Parent = MiniButton
	MiniIcon.ZIndex = 1000
	local MiniStroke = Instance.new("UIStroke")
	MiniStroke.Color = WindowStroke.Color
	MiniStroke.Thickness = WindowStroke.Thickness
	MiniStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	MiniStroke.Parent = MiniButton
	StartNeonLoop(MiniStroke)

	MakeDraggable(TopBar, Window)
	MakeDraggable(MiniButton, MiniButton)

	local function minimizeWindow()
		Window.Visible = false
		MiniButton.Visible = true
		MiniButton.Size = UDim2.fromOffset(0,0)
		TweenService:Create(MiniButton, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), { Size = MiniButtonSize }):Play()
	end
	BtnYellow.MouseButton1Click:Connect(minimizeWindow)

	BtnGreen.MouseButton1Click:Connect(function()
		if not toggledMaximized then
			lastNormalSize = Window.Size
			lastNormalPosition = Window.Position
			lastNormalAnchor = Window.AnchorPoint
			toggledMaximized = true
			Window.AnchorPoint = Vector2.new(0.5,0.5)
			Window.Position = UDim2.fromScale(0.5,0.5)
			TweenService:Create(Window, TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), { Size = UDim2.fromScale(0.9,0.85) }):Play()
		else
			toggledMaximized = false
			TweenService:Create(Window, TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), { Size = lastNormalSize, Position = lastNormalPosition }):Play()
			delay(0.25, function() Window.AnchorPoint = lastNormalAnchor end)
		end
	end)

	MiniButton.MouseButton1Click:Connect(function()
		MiniButton.Visible = false
		Window.Visible = true
		Window.Size = UDim2.fromOffset(0,0)
		if toggledMaximized then
			Window.AnchorPoint = Vector2.new(0.5,0.5)
			Window.Position = UDim2.fromScale(0.5,0.5)
			TweenService:Create(Window, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), { Size = UDim2.fromScale(0.9,0.85) }):Play()
		else
			Window.AnchorPoint = lastNormalAnchor
			Window.Position = lastNormalPosition
			TweenService:Create(Window, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), { Size = lastNormalSize, Position = lastNormalPosition }):Play()
		end
	end)

	local function ShowCloseConfirm()
		BtnYellow.Active = false
		BtnGreen.Active = false
		BtnRed.Active = false
		local Overlay = Instance.new("Frame")
		Overlay.Size = UDim2.new(1,0,1,0)
		Overlay.BackgroundColor3 = Color3.fromRGB(0,0,0)
		Overlay.BackgroundTransparency = 0.6
		Overlay.ZIndex = 50
		Overlay.Parent = Window

		local Shadow = Instance.new("Frame")
		Shadow.Size = UDim2.fromOffset(364,164)
		Shadow.AnchorPoint = Vector2.new(0.5,0.5)
		Shadow.Position = UDim2.fromScale(0.5,0.5)
		Shadow.BackgroundColor3 = Color3.fromRGB(0,0,0)
		Shadow.BackgroundTransparency = 0.75
		Shadow.ZIndex = 51
		Shadow.Parent = Overlay
		Instance.new("UICorner", Shadow).CornerRadius = UDim.new(0,14)

		local ConfirmWindow = Instance.new("Frame")
		ConfirmWindow.Size = UDim2.fromOffset(350,150)
		ConfirmWindow.AnchorPoint = Vector2.new(0.5,0.5)
		ConfirmWindow.Position = UDim2.fromScale(0.5,0.5)
		ConfirmWindow.BackgroundColor3 = Color3.fromRGB(25,25,30)
		ConfirmWindow.ZIndex = 52
		ConfirmWindow.Parent = Overlay
		Instance.new("UICorner", ConfirmWindow).CornerRadius = UDim.new(0,12)

		local confirmStroke = Instance.new("UIStroke", ConfirmWindow)
		confirmStroke.Color = WindowStroke.Color
		confirmStroke.Thickness = 2.5
		confirmStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
		StartNeonLoop(confirmStroke)

		local ConfirmText = Instance.new("TextLabel")
		ConfirmText.Size = UDim2.new(1,-32,0,48)
		ConfirmText.Position = UDim2.fromOffset(16,20)
		ConfirmText.BackgroundTransparency = 1
		ConfirmText.Text = "Are you sure you want to close the UI?"
		ConfirmText.TextColor3 = Color3.fromRGB(230,230,230)
		ConfirmText.Font = Enum.Font.GothamBold
		ConfirmText.TextSize = 18
		ConfirmText.TextWrapped = true
		ConfirmText.ZIndex = 53
		ConfirmText.Parent = ConfirmWindow

		local ButtonsFrame = Instance.new("Frame")
		ButtonsFrame.Size = UDim2.new(1,0,0,40)
		ButtonsFrame.Position = UDim2.new(0,0,1,-20)
		ButtonsFrame.AnchorPoint = Vector2.new(0,1)
		ButtonsFrame.BackgroundTransparency = 1
		ButtonsFrame.ZIndex = 53
		ButtonsFrame.Parent = ConfirmWindow

		local layout = Instance.new("UIListLayout", ButtonsFrame)
		layout.FillDirection = Enum.FillDirection.Horizontal
		layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
		layout.Padding = UDim.new(0,16)

		local ConfirmBtn = Instance.new("TextButton")
		ConfirmBtn.Size = UDim2.new(0,120,0,36)
		ConfirmBtn.BackgroundColor3 = Color3.fromRGB(0,170,255)
		ConfirmBtn.Text = "Confirm"
		ConfirmBtn.TextColor3 = Color3.fromRGB(230,230,230)
		ConfirmBtn.Font = Enum.Font.GothamBold
		ConfirmBtn.TextSize = 16
		ConfirmBtn.ZIndex = 54
		ConfirmBtn.Parent = ButtonsFrame
		Instance.new("UICorner", ConfirmBtn).CornerRadius = UDim.new(0,8)

		local CancelBtn = Instance.new("TextButton")
		CancelBtn.Size = UDim2.new(0,120,0,36)
		CancelBtn.BackgroundColor3 = Color3.fromRGB(45,45,50)
		CancelBtn.Text = "Cancel"
		CancelBtn.TextColor3 = Color3.fromRGB(220,220,220)
		CancelBtn.Font = Enum.Font.GothamBold
		CancelBtn.TextSize = 16
		CancelBtn.ZIndex = 54
		CancelBtn.Parent = ButtonsFrame
		Instance.new("UICorner", CancelBtn).CornerRadius = UDim.new(0,8)

		ConfirmBtn.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)
		CancelBtn.MouseButton1Click:Connect(function()
			Overlay:Destroy()
			BtnYellow.Active = true; BtnGreen.Active = true; BtnRed.Active = true
		end)
	end
	BtnRed.MouseButton1Click:Connect(ShowCloseConfirm)

	-- Content area
	local Content = Instance.new("Frame")
	Content.Position = UDim2.fromOffset(0,56)
	Content.Size = UDim2.new(1,0,1,-56)
	Content.BackgroundTransparency = 1
	Content.Parent = Window

	-- Sidebar
	local SideBar = Instance.new("Frame")
	SideBar.Name = "SideBar"
	SideBar.Size = UDim2.new(0,180,1,0)
	SideBar.Position = UDim2.new(0,0,0,0)
	SideBar.BackgroundColor3 = Color3.fromRGB(20,20,25)
	SideBar.BorderSizePixel = 0
	SideBar.Parent = Content
	Instance.new("UICorner", SideBar).CornerRadius = UDim.new(0,14)

	-- Divider
	local VertDivider = Instance.new("Frame")
	VertDivider.Name = "VertDivider"
	VertDivider.Size = UDim2.new(0,2,1,0)
	VertDivider.Position = UDim2.new(0,180,0,0)
	VertDivider.BackgroundColor3 = WindowStroke.Color
	VertDivider.BorderSizePixel = 0
	VertDivider.Parent = Content
	Instance.new("UICorner", VertDivider).CornerRadius = UDim.new(0,6)
	local vertDivStroke = Instance.new("UIStroke", VertDivider)
	vertDivStroke.Color = WindowStroke.Color
	vertDivStroke.Thickness = WindowStroke.Thickness
	vertDivStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	StartNeonLoop(vertDivStroke)

	-- Pages
	local Pages = Instance.new("Frame")
	Pages.Name = "Pages"
	Pages.Position = UDim2.new(0,182,0,0)
	Pages.Size = UDim2.new(1, -182, 1, 0)
	Pages.BackgroundColor3 = Color3.fromRGB(18,18,23)
	Pages.BorderSizePixel = 0
	Pages.Parent = Content
	Instance.new("UICorner", Pages).CornerRadius = UDim.new(0,12)

	-- Tabs list
	local TabsList = Instance.new("ScrollingFrame")
	TabsList.Name = "TabsList"
	TabsList.Parent = SideBar
	TabsList.Position = UDim2.fromOffset(8,8)
	TabsList.Size = UDim2.new(1, -16, 1, -16)
	TabsList.BackgroundTransparency = 1
	TabsList.BorderSizePixel = 0
	TabsList.ScrollBarThickness = 6
	TabsList.VerticalScrollBarInset = Enum.ScrollBarInset.Always
	TabsList.AutomaticCanvasSize = Enum.AutomaticSize.Y
	local tabsLayout = Instance.new("UIListLayout", TabsList)
	tabsLayout.SortOrder = Enum.SortOrder.LayoutOrder
	tabsLayout.Padding = UDim.new(0,8)

	-- tab container
	local createdTabs = {}

	-- appearance constants
	local TAB_BUTTON_HEIGHT = 44
	local TAB_CORNER_RADIUS = 6
	local TAB_BG = Color3.fromRGB(24,24,28)
	local TAB_BG_ACTIVE = Color3.fromRGB(32,32,36)
	local TAB_TEXT_COLOR = Color3.fromRGB(240,240,240)
	local TAB_TEXT_INACTIVE = Color3.fromRGB(200,200,200)

	-- Window wrapper to return
	local Win = {
		Window = Window,
		Content = Content,
		Icon = Avatar,
		MiniButton = MiniButton,
		SideBar = SideBar,
		_Pages = Pages,
		_TabsList = TabsList,
		_Tabs = createdTabs,
		_Stroke = WindowStroke,
	}

	-- CreateTab
	function Win:CreateTab(name, iconId)
		name = tostring(name or "Tab")
		local formattedIcon = FormatImage(iconId or "")

		local btn = Instance.new("TextButton")
		btn.Name = "TabButton_" .. name
		btn.Size = UDim2.new(1, -16, 0, TAB_BUTTON_HEIGHT)
		btn.BackgroundColor3 = TAB_BG
		btn.BorderSizePixel = 0
		btn.Text = ""
		btn.AutoButtonColor = false
		btn.Parent = TabsList
		Instance.new("UICorner", btn).CornerRadius = UDim.new(0, TAB_CORNER_RADIUS)

		local leftIndicator = Instance.new("Frame", btn)
		leftIndicator.Name = "LeftIndicator"
		leftIndicator.Size = UDim2.new(0,4,1,0)
		leftIndicator.Position = UDim2.new(0,0,0,0)
		leftIndicator.BackgroundColor3 = self._Stroke.Color
		leftIndicator.BorderSizePixel = 0
		leftIndicator.Visible = false
		Instance.new("UICorner", leftIndicator).CornerRadius = UDim.new(0,6)

		local iconLabel = Instance.new("ImageLabel", btn)
		iconLabel.Name = "Icon"
		iconLabel.Size = UDim2.fromOffset(28,28)
		iconLabel.Position = UDim2.new(0,10,0.5,-14)
		iconLabel.BackgroundTransparency = 1
		iconLabel.Image = formattedIcon
		Instance.new("UICorner", iconLabel).CornerRadius = UDim.new(1,0)

		local txt = Instance.new("TextLabel", btn)
		txt.Name = "Label"
		txt.Size = UDim2.new(1, -56, 1, 0)
		txt.Position = UDim2.fromOffset(48,0)
		txt.BackgroundTransparency = 1
		txt.Text = name
		txt.TextColor3 = TAB_TEXT_INACTIVE
		txt.Font = Enum.Font.Gotham
		txt.TextSize = 15
		txt.TextXAlignment = Enum.TextXAlignment.Left

		local page = Instance.new("Frame")
		page.Name = "Page_" .. name
		page.Size = UDim2.new(1,0,1,0)
		page.Position = UDim2.new(0,0,0,0)
		page.BackgroundTransparency = 1
		page.BorderSizePixel = 0
		page.Parent = self._Pages
		page.Visible = false

		-- PageContent holds sections/paragraphs stacked vertically
		local pageContent = Instance.new("Frame", page)
		pageContent.Name = "PageContent"
		pageContent.Size = UDim2.new(1, 0, 1, 0)
		pageContent.Position = UDim2.new(0,0,0,0)
		pageContent.BackgroundTransparency = 1
		pageContent.BorderSizePixel = 0
		local contentLayout = Instance.new("UIListLayout", pageContent)
		contentLayout.SortOrder = Enum.SortOrder.LayoutOrder
		contentLayout.Padding = UDim.new(0, 12)
		contentLayout.VerticalAlignment = Enum.VerticalAlignment.Top

		-- store
		local tabObj = {
			Button = btn,
			Indicator = leftIndicator,
			Label = txt,
			Icon = iconLabel,
			Page = page,
			PageContent = pageContent,
		}
		table.insert(self._Tabs, tabObj)

		-- activation
		local function activate()
			for _, t in ipairs(self._Tabs) do
				if t.Button and t.Indicator and t.Page and t.Label then
					TweenService:Create(t.Button, TweenInfo.new(0.12), { BackgroundColor3 = TAB_BG }):Play()
					t.Indicator.Visible = false
					t.Page.Visible = false
					t.Label.TextColor3 = TAB_TEXT_INACTIVE
					t.Label.Font = Enum.Font.Gotham
				end
			end
			TweenService:Create(btn, TweenInfo.new(0.12), { BackgroundColor3 = TAB_BG_ACTIVE }):Play()
			leftIndicator.Visible = true
			page.Visible = true
			txt.TextColor3 = TAB_TEXT_COLOR
			txt.Font = Enum.Font.GothamBold
			page.Parent = self._Pages
		end

		-- hover
		local hoverTweenInfo = TweenInfo.new(0.10, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
		local hoverBG = Color3.fromRGB(28,28,31)
		local leaveBG = TAB_BG
		btn.MouseEnter:Connect(function()
			if not leftIndicator.Visible then
				TweenService:Create(btn, hoverTweenInfo, { BackgroundColor3 = hoverBG }):Play()
				txt.TextColor3 = Color3.fromRGB(220,220,220)
			end
		end)
		btn.MouseLeave:Connect(function()
			if not leftIndicator.Visible then
				TweenService:Create(btn, hoverTweenInfo, { BackgroundColor3 = leaveBG }):Play()
				txt.TextColor3 = TAB_TEXT_INACTIVE
			end
		end)
		btn.MouseButton1Click:Connect(activate)

		if #self._Tabs == 1 then activate() end

		-- public api for the tab
		local public = {
			Button = btn,
			Page = page,
			_PageContent = pageContent,
			_Stroke = self._Stroke, -- expose window stroke so paragraphs can read accent
			Activate = activate,
			SetIcon = function(newIcon) iconLabel.Image = FormatImage(newIcon) end,
			SetText = function(newText) txt.Text = tostring(newText or "") end,
		}

		-- Section API
		function public:Section(title)
			title = tostring(title or "")
			-- wrapper for section content (full width)
			local sectionFrame = Instance.new("Frame")
			sectionFrame.Name = "Section_" .. title
			sectionFrame.Size = UDim2.new(1, -24, 0, 96) -- initial height; grows with children
			sectionFrame.BackgroundTransparency = 1
			sectionFrame.BorderSizePixel = 0
			sectionFrame.Parent = self._PageContent

			-- Title area
			local titleLabel = Instance.new("TextLabel", sectionFrame)
			titleLabel.Name = "SectionTitle"
			titleLabel.Size = UDim2.new(1, 0, 0, 36)
			titleLabel.Position = UDim2.fromOffset(0, 8)
			titleLabel.BackgroundTransparency = 1
			titleLabel.Text = title
			titleLabel.TextColor3 = Color3.fromRGB(0,120,255) -- blue
			titleLabel.Font = Enum.Font.GothamBold
			titleLabel.TextSize = 22
			titleLabel.TextWrapped = true
			titleLabel.TextXAlignment = Enum.TextXAlignment.Center

			-- separator
			local sep = Instance.new("Frame", sectionFrame)
			sep.Name = "SectionSeparator"
			sep.Size = UDim2.new(1, -40, 0, 2)
			sep.Position = UDim2.fromOffset(20, 48)
			sep.AnchorPoint = Vector2.new(0,0)
			sep.BackgroundColor3 = Color3.fromRGB(38,38,42)
			sep.BorderSizePixel = 0
			Instance.new("UICorner", sep).CornerRadius = UDim.new(0,4)

			-- Content holder inside section (stacks children)
			local sectionContent = Instance.new("Frame", sectionFrame)
			sectionContent.Name = "SectionContent"
			sectionContent.Size = UDim2.new(1, 0, 0, 48)
			sectionContent.Position = UDim2.fromOffset(0, 64)
			sectionContent.BackgroundTransparency = 1
			sectionContent.BorderSizePixel = 0

			local secLayout = Instance.new("UIListLayout", sectionContent)
			secLayout.SortOrder = Enum.SortOrder.LayoutOrder
			secLayout.Padding = UDim.new(0,8)
			secLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

			-- keep sectionFrame height in sync with sectionContent
			secLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
				local contentH = secLayout.AbsoluteContentSize.Y
				sectionContent.Size = UDim2.new(1,0,0, contentH)
				local total = 64 + contentH + 12 -- title area + content + padding
				sectionFrame.Size = UDim2.new(1, -24, 0, math.max(96, total))
			end)

			-- API for section: AddLabel + AddParagraph (centered)
			local sectionPublic = {
				Frame = sectionFrame,
				TitleLabel = titleLabel,
				AddLabel = function(self, text)
					local label = Instance.new("TextLabel")
					label.Size = UDim2.new(1, -40, 0, 24)
					label.BackgroundTransparency = 1
					label.Text = tostring(text or "")
					label.TextColor3 = Color3.fromRGB(220,220,220)
					label.Font = Enum.Font.Gotham
					label.TextSize = 14
					label.TextXAlignment = Enum.TextXAlignment.Left
					label.Parent = sectionContent
					return label
				end,
				AddParagraph = function(self, ptitle, pbody)
					ptitle = tostring(ptitle or "")
					pbody = tostring(pbody or "")

					-- measure width from sectionContent (fallback if not measured yet)
					local measuredWidth = 520
					if sectionContent and sectionContent.AbsoluteSize and sectionContent.AbsoluteSize.X and sectionContent.AbsoluteSize.X > 0 then
						measuredWidth = sectionContent.AbsoluteSize.X
					end

					-- size calculations
					local titleHeight = 0
					if ptitle ~= "" then
						local ts = TextService:GetTextSize(ptitle, 16, Enum.Font.GothamBold, Vector2.new(measuredWidth * 0.95 - 32, 1000))
						titleHeight = math.max(22, math.ceil(ts.Y))
					end
					local bodySize = TextService:GetTextSize(pbody, 14, Enum.Font.Gotham, Vector2.new(measuredWidth * 0.95 - 32, 2000))
					local bodyHeight = math.ceil(bodySize.Y)
					local totalHeight = 12 + titleHeight + 8 + bodyHeight + 12

					-- wrapper so UIListLayout can center children
					local wrapper = Instance.new("Frame")
					wrapper.Name = "ParagraphWrapper"
					wrapper.Size = UDim2.new(1, 0, 0, totalHeight + 20)
					wrapper.BackgroundTransparency = 1
					wrapper.Parent = sectionContent

					-- inner paragraph (centered horizontally)
					local paraFrame = Instance.new("Frame", wrapper)
					paraFrame.Name = "Paragraph"
					paraFrame.AnchorPoint = Vector2.new(0.5,0)
					paraFrame.Position = UDim2.new(0.5, 0, 0, 10)
					paraFrame.Size = UDim2.new(0.95, 0, 0, totalHeight)
					paraFrame.BackgroundColor3 = Color3.fromRGB(24,24,28)
					paraFrame.BorderSizePixel = 0
					Instance.new("UICorner", paraFrame).CornerRadius = UDim.new(0,8)
					paraFrame.ZIndex = 2

					-- faint glow behind paragraph (very subtle)
					local glow = Instance.new("Frame", wrapper)
					glow.Name = "ParagraphGlow"
					glow.AnchorPoint = Vector2.new(0.5,0)
					glow.Position = UDim2.new(0.5, 0, 0, 8)
					glow.Size = UDim2.new(0.96, 0, 0, totalHeight + 14)
					glow.BackgroundTransparency = 0.96 -- very faint (prevent dark blob)
					glow.BorderSizePixel = 0
					if Win._Stroke and Win._Stroke.Color then
						glow.BackgroundColor3 = Win._Stroke.Color
					else
						glow.BackgroundColor3 = Color3.fromRGB(0,160,255)
					end
					Instance.new("UICorner", glow).CornerRadius = UDim.new(0,10)
					StartNeonLoop(glow)

					-- stroke on paragraph
					local paraStroke = Instance.new("UIStroke", paraFrame)
					paraStroke.Thickness = 2
					paraStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
					if Win._Stroke and Win._Stroke.Color then
						paraStroke.Color = Win._Stroke.Color
					else
						paraStroke.Color = Color3.fromRGB(0,160,255)
					end
					StartNeonLoop(paraStroke)

					-- inner padding
					local inner = Instance.new("Frame", paraFrame)
					inner.Size = UDim2.new(1, -20, 1, -20)
					inner.Position = UDim2.fromOffset(10,10)
					inner.BackgroundTransparency = 1
					inner.BorderSizePixel = 0

					-- title
					if ptitle ~= "" then
						local titleLabel = Instance.new("TextLabel", inner)
						titleLabel.Name = "ParagraphTitle"
						titleLabel.Size = UDim2.new(1, 0, 0, titleHeight)
						titleLabel.Position = UDim2.fromOffset(0,0)
						titleLabel.BackgroundTransparency = 1
						titleLabel.Text = ptitle
						titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
						titleLabel.Font = Enum.Font.GothamBold
						titleLabel.TextSize = 16
						titleLabel.TextXAlignment = Enum.TextXAlignment.Left
						titleLabel.TextWrapped = true
					end

					-- body
					local bodyLabel = Instance.new("TextLabel", inner)
					bodyLabel.Name = "ParagraphBody"
					bodyLabel.Size = UDim2.new(1, 0, 0, bodyHeight)
					bodyLabel.Position = UDim2.fromOffset(0, titleHeight + 8)
					bodyLabel.BackgroundTransparency = 1
					bodyLabel.Text = pbody
					bodyLabel.TextColor3 = Color3.fromRGB(255,255,255)
					bodyLabel.Font = Enum.Font.Gotham
					bodyLabel.TextSize = 14
					bodyLabel.TextWrapped = true
					bodyLabel.TextXAlignment = Enum.TextXAlignment.Left
					bodyLabel.TextYAlignment = Enum.TextYAlignment.Top

					-- return small API
					local paraPublic = {
						Wrapper = wrapper,
						Frame = paraFrame,
						BodyLabel = bodyLabel,
						SetText = function(self, newText)
							newText = tostring(newText or "")
							bodyLabel.Text = newText
							-- remeasure and adjust sizes (defer to allow layout)
							task.defer(function()
								local w = 520
								if sectionContent and sectionContent.AbsoluteSize and sectionContent.AbsoluteSize.X > 0 then
									w = sectionContent.AbsoluteSize.X * 0.95
								end
								local newTitleH = 0
								if ptitle ~= "" then
									local ts2 = TextService:GetTextSize(ptitle, 16, Enum.Font.GothamBold, Vector2.new(w - 32, 1000))
									newTitleH = math.max(22, math.ceil(ts2.Y))
								end
								local newBodySize2 = TextService:GetTextSize(newText, 14, Enum.Font.Gotham, Vector2.new(w - 32, 2000))
								local newBodyH2 = math.ceil(newBodySize2.Y)
								local newTotal = 12 + newTitleH + 8 + newBodyH2 + 12
								paraFrame.Size = UDim2.new(0.95, 0, 0, newTotal)
								glow.Size = UDim2.new(0.96, 0, 0, newTotal + 14)
								wrapper.Size = UDim2.new(1,0,0,newTotal + 20)
								if paraFrame:FindFirstChild("ParagraphTitle") then
									paraFrame.ParagraphTitle.Size = UDim2.new(1,0,0,newTitleH)
								end
								bodyLabel.Size = UDim2.new(1,0,0,newBodyH2)
							end)
						end,
					}
					return paraPublic
				end,
			}
			return sectionPublic
		end

		-- Tab-level Paragraph (backwards compatible) - adds to page content (not the section)
		function public:Paragraph(ptitle, pbody)
			-- reuse section's centered paragraph logic but inside pageContent (as full-width wrapper)
			ptitle = tostring(ptitle or "")
			pbody = tostring(pbody or "")
			local pageContentRef = self._PageContent

			local measuredWidth = 520
			if pageContentRef and pageContentRef.AbsoluteSize and pageContentRef.AbsoluteSize.X and pageContentRef.AbsoluteSize.X > 0 then
				measuredWidth = pageContentRef.AbsoluteSize.X
			end
			local titleHeight = 0
			if ptitle ~= "" then
				local ts = TextService:GetTextSize(ptitle, 16, Enum.Font.GothamBold, Vector2.new(measuredWidth * 0.95 - 32, 1000))
				titleHeight = math.max(22, math.ceil(ts.Y))
			end
			local bodySize = TextService:GetTextSize(pbody, 14, Enum.Font.Gotham, Vector2.new(measuredWidth * 0.95 - 32, 2000))
			local bodyHeight = math.ceil(bodySize.Y)
			local totalHeight = 12 + titleHeight + 8 + bodyHeight + 12

			-- wrapper for centering in pageContent
			local wrapper = Instance.new("Frame")
			wrapper.Name = "ParagraphWrapper"
			wrapper.Size = UDim2.new(1,0,0,totalHeight + 20)
			wrapper.BackgroundTransparency = 1
			wrapper.Parent = pageContentRef

			local paraFrame = Instance.new("Frame", wrapper)
			paraFrame.Name = "Paragraph"
			paraFrame.AnchorPoint = Vector2.new(0.5,0)
			paraFrame.Position = UDim2.new(0.5, 0, 0, 10)
			paraFrame.Size = UDim2.new(0.95, 0, 0, totalHeight)
			paraFrame.BackgroundColor3 = Color3.fromRGB(24,24,28)
			Instance.new("UICorner", paraFrame).CornerRadius = UDim.new(0,8)

			local glow = Instance.new("Frame", wrapper)
			glow.Name = "ParagraphGlow"
			glow.AnchorPoint = Vector2.new(0.5,0)
			glow.Position = UDim2.new(0.5, 0, 0, 8)
			glow.Size = UDim2.new(0.96, 0, 0, totalHeight + 14)
			if self._Stroke and self._Stroke.Color then
				glow.BackgroundColor3 = self._Stroke.Color
			else
				glow.BackgroundColor3 = Color3.fromRGB(0,160,255)
			end
			glow.BackgroundTransparency = 0.96 -- very faint
			Instance.new("UICorner", glow).CornerRadius = UDim.new(0,10)
			StartNeonLoop(glow)

			local paraStroke = Instance.new("UIStroke", paraFrame)
			paraStroke.Thickness = 2
			paraStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
			if self._Stroke and self._Stroke.Color then
				paraStroke.Color = self._Stroke.Color
			else
				paraStroke.Color = Color3.fromRGB(0,160,255)
			end
			StartNeonLoop(paraStroke)

			local inner = Instance.new("Frame", paraFrame)
			inner.Size = UDim2.new(1, -20, 1, -20)
			inner.Position = UDim2.fromOffset(10,10)
			inner.BackgroundTransparency = 1

			if ptitle ~= "" then
				local titleLabel = Instance.new("TextLabel", inner)
				titleLabel.Name = "ParagraphTitle"
				titleLabel.Size = UDim2.new(1,0,0,titleHeight)
				titleLabel.Position = UDim2.fromOffset(0,0)
				titleLabel.BackgroundTransparency = 1
				titleLabel.Text = ptitle
				titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
				titleLabel.Font = Enum.Font.GothamBold
				titleLabel.TextSize = 16
				titleLabel.TextXAlignment = Enum.TextXAlignment.Left
				titleLabel.TextWrapped = true
			end

			local bodyLabel = Instance.new("TextLabel", inner)
			bodyLabel.Name = "ParagraphBody"
			bodyLabel.Size = UDim2.new(1,0,0,bodyHeight)
			bodyLabel.Position = UDim2.fromOffset(0, titleHeight + 8)
			bodyLabel.BackgroundTransparency = 1
			bodyLabel.Text = pbody
			bodyLabel.TextColor3 = Color3.fromRGB(255,255,255)
			bodyLabel.Font = Enum.Font.Gotham
			bodyLabel.TextSize = 14
			bodyLabel.TextWrapped = true
			bodyLabel.TextXAlignment = Enum.TextXAlignment.Left
			bodyLabel.TextYAlignment = Enum.TextYAlignment.Top

			local publicPara = {
				Wrapper = wrapper,
				Frame = paraFrame,
				BodyLabel = bodyLabel,
				SetText = function(self, newText)
					newText = tostring(newText or "")
					bodyLabel.Text = newText
					task.defer(function()
						local w = 520
						if pageContentRef and pageContentRef.AbsoluteSize and pageContentRef.AbsoluteSize.X > 0 then
							w = pageContentRef.AbsoluteSize.X * 0.95
						end
						local newTitleH = 0
						if ptitle ~= "" then
							local ts2 = TextService:GetTextSize(ptitle, 16, Enum.Font.GothamBold, Vector2.new(w - 32, 1000))
							newTitleH = math.max(22, math.ceil(ts2.Y))
						end
						local newBodySize2 = TextService:GetTextSize(newText, 14, Enum.Font.Gotham, Vector2.new(w - 32, 2000))
						local newBodyH2 = math.ceil(newBodySize2.Y)
						local newTotal = 12 + newTitleH + 8 + newBodyH2 + 12
						paraFrame.Size = UDim2.new(0.95,0,0,newTotal)
						glow.Size = UDim2.new(0.96,0,0,newTotal + 14)
						wrapper.Size = UDim2.new(1,0,0,newTotal + 20)
						if paraFrame:FindFirstChild("ParagraphTitle") then
							paraFrame.ParagraphTitle.Size = UDim2.new(1,0,0,newTitleH)
						end
						bodyLabel.Size = UDim2.new(1,0,0,newBodyH2)
					end)
				end,
			}
			return publicPara
		end

		return public
	end

	-- convenience: list tabs
	function Win:GetTabs()
		local out = {}
		for i,t in ipairs(self._Tabs) do
			table.insert(out, { Index = i, Button = t.Button, Page = t.Page })
		end
		return out
	end

	if typeof(Callback) == "function" then
		pcall(Callback)
	end

	return Win
end

return KazeUI
